<!doctype html>
NSK Lag
    <img class="nsk-logo" src="./icon-192.png" alt="NSK">
    <div>
      <h1>NSK Lag</h1>
      <div class="small">Matchinfo • Laguppställning • Byten • PDF</div>
    </div>

    <div class="card">
      <div class="homeActions">
        <button type="button" class="ghost" onclick="openRegister()">Truppen team 18</button>
        <button type="button" onclick="openNewPool()">Skapa nytt poolspel</button>
        <button type="button" class="ghost" onclick="openGoalieStats()">Statistik målvakter</button>
      </div>
      <div class="small" style="margin-top:10px;">
        Skapa ett nytt poolspel (datum + ort), eller öppna ett sparat poolspel nedan.
      </div>
    </div>

    <div class="card">
      <b>Sparade poolspel</b>
      <div id="poolList" class="poolList" style="margin-top:10px;"></div>
    </div>

    <div class="card no-print">
      <div class="topbar">
        <div class="left">
          <button type="button" class="ghost" onclick="goHome()">← Startsida</button>
          <div>
            <h2 id="currentPoolTitle">Poolspel</h2>
            <div id="currentPoolSub" class="sub"></div>
          </div>
        </div>
        <div class="btnrow">
          <button type="button" class="ghost" onclick="finishPool()">Spara som klar</button>
        </div>
      </div>
    </div>

    <!-- TEAM TABS (högst upp) -->
    <div class="tabsTop no-print">
      <div class="tabs" id="teamTabs">
        <button type="button" class="tabbtn" data-team="1">Lag 1</button>
        <button type="button" class="tabbtn" data-team="2">Lag 2</button>
        <button type="button" class="tabbtn" data-team="3">Lag 3</button>
      </div>
      <select id="teamSelect" style="display:none;">
        <option value="1">Lag 1</option>
        <option value="2">Lag 2</option>
        <option value="3">Lag 3</option>
      </select>
    </div>

    <!-- TOPP: MATCHINFO -->
    <div class="card no-print">
      <div class="row">
        <div>
          <label>Antal matcher</label>
          <select id="matchCount"></select>
        </div>

        <div>
          <label>Match</label>
          <select id="matchNo"></select>
        </div>

        <div>
          <label>Datum</label>
          <input id="matchDate" type="date">
        </div>

        <div>
          <label>Starttid</label>
          <input id="matchTime" type="time">
        </div>
      </div>

      <div class="row" style="margin-top:10px;">
        <div>
          <label>Motståndare</label>
          <input id="opponent" placeholder="Skriv motståndare">
        </div>
        <div>
          <label>Plan</label>
          <select id="arena"></select>
        </div>
      </div>

      <div class="row" style="margin-top:10px;">
        <div>
          <label>Antal i laget</label>
          <select id="teamSize"></select>
        </div>
        <div>
          <label>Antal på plan</label>
          <select id="onCourt"></select>
        </div>
        <div>
          <label>Perioder per match</label>
          <select id="periodsCount"></select>
        </div>
        <div>
          <label>Periodtid (min)</label>
          <select id="periodMin"></select>
        </div>
        <div>
          <label>Bytestid (sek)</label>
          <select id="shiftSec"></select>
        </div>
      </div>

      <div style="margin-top:10px;" class="small">
        Allt sparas automatiskt per poolspel + lag + match.
        <span id="saveState" class="pill" style="margin-left:8px;">Redo</span>
      </div>
    </div>

    <!-- LAGUPPSTÄLLNING -->
    <div class="card no-print">
      <b>Spelare (denna match)</b>
      <div id="playersContainer" class="row" style="margin-top:10px;"></div>
      <div class="hint">Spelare 1 är bäst, spelare 2 näst bäst osv (används i bytestipsen).</div>

      <div class="row" style="margin-top:10px;">
        <div>
          <label>Målvakt</label>
          <select id="goalie"></select>
        </div>
        <div>
          <label>Tränare (samma för alla matcher i laget)</label>
          <select id="coach" multiple></select>
          <div class="hint">Tips: Markera flera genom att trycka flera gånger (mobil) / Ctrl/⌘ (dator).</div>
        </div>
      </div>

      <div id="msg" class="small" style="margin-top:10px;"></div>

      <div class="btnrow no-print" style="margin-top:12px;">
        <button type="button" onclick="renderAll()">Skapa matchblad</button>
        <button type="button" class="ghost" onclick="exportPDF()">Dela PDF</button>
        <button type="button" class="ghost" onclick="clearTeamMatch()">Rensa (lag+match)</button>
      </div>

      <div id="exportHelp" class="small no-print" style="margin-top:8px;display:none;"></div>
    </div>

    <!-- OUTPUT / MATCHBLAD (PRINT-VÄNLIGT) -->
    <div class="card print-card" id="output">
      <b>Matchblad</b>
      <div class="small">Fyll i och tryck “Skapa matchblad”.</div>
    </div>

    <div class="card no-print">
      <div style="display:flex;justify-content:space-between;gap:10px;align-items:flex-end;flex-wrap:wrap;">
        <div>
          <b id="currentRunTitle">Poolspel</b>
          <div class="small" id="currentRunSub"></div>
        </div>
        <div class="btnrow" style="margin:0;">
          <button type="button" class="ghost" onclick="goHome()">Till startsida</button>
          <button type="button" class="ghost" onclick="openPool(currentPoolId())">Redigera</button>
          <button type="button" onclick="finishPool()">Spara som klar</button>
        </div>
      </div>
      <div class="small" style="margin-top:8px;">
        Visar endast <b>match</b>, <b>lag</b>, <b>tränare</b>, <b>målvakt</b> och <b>bytesschema</b>. Bocka av när bytet är klart.
      </div>
    </div>

    <div class="card print-card" id="runOutput">
      <b>Poolspel</b>
      <div class="small">Välj ett poolspel och tryck “Påbörja poolspel”.</div>
    </div>

    <div class="modalPanel">
      <div class="modalHeader">
        <b>Truppen team 18</b>
        <button class="ghost" type="button" onclick="closeRegister()">Stäng</button>
      </div>

      <div class="twoCols">
        <div class="card" style="margin:0;">
          <b>Spelare</b>
          <div class="row" style="margin-top:10px;">
            <input id="newPlayer" placeholder="Förnamn Efternamn">
            <button type="button" onclick="addPlayer()">Lägg till</button>
          </div>
          <div id="playerList" style="margin-top:10px;"></div>
          <div class="small" style="margin-top:8px;">Sorteras A–Ö. Sparas i telefonen.</div>
        </div>

        <div class="card" style="margin:0;">
          <b>Tränare</b>
          <div class="row" style="margin-top:10px;">
            <input id="newCoach" placeholder="Förnamn Efternamn">
            <button type="button" onclick="addCoach()">Lägg till</button>
          </div>
          <div id="coachList" style="margin-top:10px;"></div>
          <div class="small" style="margin-top:8px;">Sorteras A–Ö. Sparas i telefonen.</div>
        </div>
      </div>

      <div class="card" style="margin-top:12px;">
        <b>Backup / Flytta till annan telefon</b>
        <div class="small" style="margin-top:6px;">
          Export/Import av register + alla lag/matcher.
        </div>
        <div class="btnrow" style="margin-top:10px;">
          <button type="button" class="ghost" onclick="exportJSON()">Exportera JSON</button>
          <label style="margin:0; flex: 1 1 260px;">
            <span class="small">Importera JSON</span>
            <input id="importFile" type="file" accept="application/json" />
          </label>
        </div>
        <div id="importMsg" class="small" style="margin-top:8px;"></div>
      </div>
    </div>

    <div class="modalPanel">
      <div class="modalHeader">
        <b>Statistik målvakter</b>
        <button class="ghost" type="button" onclick="closeGoalieStats()">Stäng</button>
      </div>

      <div class="card" style="margin:0;">
        <div class="small" style="margin-bottom:8px;">
          Visar hur många <b>matcher</b> en spelare varit vald som målvakt (max 1 gång per match). <span class="pill">Alla lag</span>
        </div>
        <div id="goalieStatsList"></div>
        <div id="goalieStatsHint" class="small" style="margin-top:10px;"></div>
      </div>
    </div>

    <div class="modalPanel">
      <div class="modalHeader">
        <b>Skapa nytt poolspel</b>
        <button class="ghost" type="button" onclick="closeNewPool()">Stäng</button>
      </div>
      <div class="card" style="margin:0;">
        <div class="row">
          <div>
            <label>Datum</label>
            <input id="poolDate" type="date" />
          </div>
          <div>
            <label>Ort</label>
            <input id="poolPlace" placeholder="Ort" />
          </div>
        </div>
        <div class="btnrow" style="margin-top:12px;">
          <button type="button" onclick="saveNewPool()">Spara</button>
        </div>
        <div id="poolMsg" class="small" style="margin-top:8px;"></div>
      </div>
    </div>

    <div class="modalPanel">
      <div class="modalHeader">
        <b>Välj lag</b>
        <button class="ghost" type="button" onclick="closeTeamSelect()">Stäng</button>
      </div>
      <div id="teamSelectList" class="card" style="margin:0;"></div>
    </div>

    <div class="modalHeader">
      <b>Välj lag</b>
      <button class="ghost" type="button" onclick="closeTeamSelect()">Stäng</button>
    </div>
    <div id="teamSelectList" class="card" style="margin:0;"></div>
