<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NSK Lag</title>

  <style>
    body { font-family: -apple-system, system-ui, Arial; margin: 14px; }
    .card { border: 1px solid #ddd; border-radius: 14px; padding: 12px; margin: 12px 0; }
    .row { display:flex; gap:10px; flex-wrap:wrap; }
    .row > * { flex: 1 1 140px; }
    label { display:block; font-size: 12px; color:#555; margin-bottom: 6px; }
    select, input { width:100%; padding:10px; border-radius:10px; border:1px solid #ccc; }
    .btnrow { display:flex; gap:10px; }
    button { padding:12px 14px; border-radius:12px; border:0; background:#111; color:#fff; font-weight:600; }
    button.ghost { background:#f2f2f2; color:#111; border:1px solid #ddd; }
    .small { font-size: 12px; color:#666; }
    .nsk-top { display:flex; align-items:center; gap:12px; margin-bottom: 12px; }
    .nsk-logo { width:56px; height:56px; border-radius:14px; object-fit:cover; border:1px solid #ddd; }
    h1 { margin:0; font-size: 22px; }
    @media print {
      button, .no-print { display:none !important; }
      body { margin: 0; }
      .card { border: none; }
    }
  </style>

  <!-- PWA (valfritt) -->
  <link rel="manifest" href="manifest.webmanifest">
</head>

<body>

  <!-- SNYGG TOPP: logga + titel -->
  <div class="nsk-top">
    <img class="nsk-logo" src="./icon-192.png" alt="NSK">
    <div>
      <h1>NSK Lag</h1>
      <div class="small">Laguppst√§llning ‚Ä¢ Byten ‚Ä¢ PDF</div>
    </div>
  </div>

  <div class="card">
    <div class="row">
      <div>
        <label>Lag</label>
        <select id="teamSelect">
          <option value="1">Lag 1</option>
          <option value="2">Lag 2</option>
          <option value="3">Lag 3</option>
        </select>
      </div>
      <div>
        <label>Motst√•ndare</label>
        <input id="opponent" placeholder="Skriv motst√•ndare">
      </div>
      <div>
        <label>Plan</label>
        <input id="arena" placeholder="Skriv plan">
      </div>
    </div>
  </div>

  <div class="card">
    <div class="row">
      <div>
        <label>Spelare 1</label>
        <select class="playerSel" id="p1"></select>
      </div>
      <div>
        <label>Spelare 2</label>
        <select class="playerSel" id="p2"></select>
      </div>
      <div>
        <label>Spelare 3</label>
        <select class="playerSel" id="p3"></select>
      </div>
      <div>
        <label>Spelare 4</label>
        <select class="playerSel" id="p4"></select>
      </div>
    </div>

    <div class="row" style="margin-top:10px;">
      <div>
        <label>M√•lvakt</label>
        <select id="goalie"></select>
      </div>
      <div>
        <label>Tr√§nare</label>
        <select id="coach"></select>
      </div>
    </div>

    <div class="btnrow no-print" style="margin-top:12px;">
      <button onclick="renderLineup()">Skapa laguppst√§llning</button>
      <button class="ghost" onclick="exportPDF()">Dela PDF</button>
    </div>

    <div id="exportHelp" class="small no-print" style="margin-top:8px;display:none;"></div>
  </div>

  <div class="card" id="output">
    <b>Laguppst√§llning</b>
    <div class="small">Fyll i och tryck ‚ÄúSkapa laguppst√§llning‚Äù.</div>
  </div>

<script>
  // Exempeldata (byt g√§rna mot din riktiga lista senare)
  const PLAYERS = [
    "Alex Andersson","Benjamin Berg","Carl Carlsson","David Dahl",
    "Elias Eriksson","Filip Friberg","Gustav Gran","Hugo Holm"
  ].sort((a,b)=>a.localeCompare(b,'sv'));

  const COACHES = ["Peter","Olle","Fredrik","Tommy"].sort((a,b)=>a.localeCompare(b,'sv'));

  function fillSelect(sel, items, placeholder="V√§lj..."){
    sel.innerHTML = "";
    const opt0 = document.createElement("option");
    opt0.value = "";
    opt0.textContent = placeholder;
    sel.appendChild(opt0);
    for (const name of items){
      const o = document.createElement("option");
      o.value = name;
      o.textContent = name;
      sel.appendChild(o);
    }
  }

  function init(){
    // spelare 1-4 + m√•lvakt
    for (const id of ["p1","p2","p3","p4","goalie"]){
      fillSelect(document.getElementById(id), PLAYERS);
    }
    fillSelect(document.getElementById("coach"), COACHES);
  }

  function renderLineup(){
    const team = document.getElementById("teamSelect").value;
    const opponent = document.getElementById("opponent").value || "‚Äî";
    const arena = document.getElementById("arena").value || "‚Äî";

    const chosen = ["p1","p2","p3","p4"].map(id=>document.getElementById(id).value).filter(Boolean);
    const goalie = document.getElementById("goalie").value || "‚Äî";
    const coach = document.getElementById("coach").value || "‚Äî";

    const out = document.getElementById("output");
    out.innerHTML = `
      <div><b>Lag ${team}</b></div>
      <div class="small">Motst√•ndare: <b>${escapeHtml(opponent)}</b> ‚Ä¢ Plan: <b>${escapeHtml(arena)}</b></div>
      <hr>
      <div><b>Spelare</b></div>
      <ol>${chosen.map(n=>`<li>${escapeHtml(n)}</li>`).join("") || "<li>‚Äî</li>"}</ol>
      <div><b>M√•lvakt:</b> ${escapeHtml(goalie)}</div>
      <div><b>Tr√§nare:</b> ${escapeHtml(coach)}</div>
    `;
  }

  function exportPDF(){
    const help = document.getElementById("exportHelp");
    help.style.display = "block";
    help.innerHTML =
      "üìÑ iPhone: Tryck <b>Skriv ut</b> ‚Üí nyp ut p√• f√∂rhandsvisningen ‚Üí <b>Dela</b> PDF.<br>" +
      "üìÑ Android: V√§lj <b>Spara som PDF</b>.";

    window.print();
  }

  function escapeHtml(s){
    return String(s).replace(/[&<>"']/g, m => ({
      "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
    }[m]));
  }
// ladda r√§tt lag direkt vid start
loadTeamState();

// spara vid √§ndring i alla f√§lt
["opponent","arena","p1","p2","p3","p4","goalie","coach"].forEach(id=>{
  document.getElementById(id).addEventListener("change", saveTeamState);
  document.getElementById(id).addEventListener("input", saveTeamState);
});

// n√§r man byter lag: spara nuvarande och ladda nya lagets data
document.getElementById("teamSelect").addEventListener("change", ()=>{
  // spara innan byte (s√§kerhets skull)
  // (OBS: teamSelect har redan √§ndrats h√§r, s√• vi sparar inte gamla laget)
  // d√§rf√∂r: spara alltid n√§r f√§lt √§ndras (ovan) r√§cker.
  loadTeamState();
});
  init();
  function teamKey(){
  const team = document.getElementById("teamSelect").value;
  return "nsklag_team_" + team;
}

function getFormState(){
  return {
    opponent: document.getElementById("opponent").value || "",
    arena: document.getElementById("arena").value || "",
    p1: document.getElementById("p1").value || "",
    p2: document.getElementById("p2").value || "",
    p3: document.getElementById("p3").value || "",
    p4: document.getElementById("p4").value || "",
    goalie: document.getElementById("goalie").value || "",
    coach: document.getElementById("coach").value || ""
  };
}

function setFormState(s){
  document.getElementById("opponent").value = s.opponent || "";
  document.getElementById("arena").value = s.arena || "";
  document.getElementById("p1").value = s.p1 || "";
  document.getElementById("p2").value = s.p2 || "";
  document.getElementById("p3").value = s.p3 || "";
  document.getElementById("p4").value = s.p4 || "";
  document.getElementById("goalie").value = s.goalie || "";
  document.getElementById("coach").value = s.coach || "";
}

function saveTeamState(){
  localStorage.setItem(teamKey(), JSON.stringify(getFormState()));
}

function loadTeamState(){
  const raw = localStorage.getItem(teamKey());
  if (!raw) {
    setFormState({}); // tomt f√∂r nytt lag
    return;
  }
  try {
    setFormState(JSON.parse(raw));
  } catch {
    setFormState({});
  }
}
</script>

</body>
</html>